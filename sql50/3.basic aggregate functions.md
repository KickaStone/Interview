# 620. Not Boring Movies

Write a solution to report the movies with an odd-numbered ID and a description that is not "boring".

```sql
select * from Cinema
where id % 2 = 1 and description != "boring"
order by rating desc;
```

# 1251. Average Selling Price

```sql
SELECT 
    p.product_id,
    ROUND(
        COALESCE(SUM(u.units * p.price) / SUM(u.units), 0), 
        2
    ) AS average_price
FROM Prices p
LEFT JOIN UnitsSold u
    ON p.product_id = u.product_id
   AND u.purchase_date BETWEEN p.start_date AND p.end_date
GROUP BY p.product_id;
```

`COALESCE` 用来进行空值处理，其参数格式如下： 
`COALESCE ( expression,value1,value2……,valuen)`, 默认返回valuen

# 1075. Project Employees I

```sql
select t1.project_id, round(avg(experience_years),2) as average_years  from 
Project as t1 join Employee as t2 on t1.employee_id = t2.employee_id 
group by t1.project_id;
```

# 1633. Percentage of Users Attended a Contest

```sql
select 
    contest_id,
    round(100.0 * count(user_id) / (select count(*) from Users),2) as percentage 
from
    Register
group by contest_id
order by percentage desc, contest_id
```

# 1211. Queries Quality and Percentage

```sql
select 
    query_name, 
    round(avg(rating*1.0/position),2) as quality, 
    round(100.0*count(if(rating < 3, 1, null))/count(*),2) as poor_query_percentage
from 
    Queries
group by 
    query_name
```

# 1193. Monthly Transactions I
```sql
select 
    left(trans_date, 7) as month,
    country,
    count(*) as trans_count,
    count(if(state="approved", 1, null)) as approved_count,
    sum(amount) as trans_total_amount,
    sum(if(state="approved", amount, 0)) as approved_total_amount 
from 
    Transactions
group by 
    month, country
```


# 1174. Immediate Food Delivery II
```sql
select 
    round(100.0*count(if(customer_pref_delivery_date  = date1, 1, null)) / count(*),2) as immediate_percentage 
from
    Delivery as t1
join 
    (select customer_id, min(order_date) as date1  from Delivery 
group by customer_id ) as t2
on t1.order_date = t2.date1 and t1.customer_id = t2.customer_id
```

# 550. Game Play Analysis IV

```sql
select 
    round(count(t2.player_id) / count(distinct t1.player_id), 2) as fraction  
from Activity as t1 
left join
    (select player_id, min(event_date) as first_login_date
from Activity
group by player_id) as t2
on t1.player_id = t2.player_id and datediff(t1.event_date, t2.first_login_date) = 1
```